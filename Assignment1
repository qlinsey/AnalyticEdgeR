AN ANALYTICAL DETECTIVE

setwd("/Users/xipang/Documents/DataMining/courses/AnalyticsEdge/")
mvt<-read.csv("mvtWeek1.csv")
str(mvt)
DateConvert = as.Date(strptime(mvt$Date, "%m/%d/%y %H:%M"))
#Problem 2.3 - Understanding Dates in R
#In which month did the fewest motor vehicle thefts occur?
mvt$Month = months(DateConvert)
mvt$Weekday = weekdays(DateConvert)
mvt$Date = DateConvert
which.min(table(mvt$Month))

#Problem 2.4 - Understanding Dates in R 
#On which weekday did the most motor vehicle thefts occur?
which.max(table(mvt$Weekday))

#Problem 2.5 - Understanding Dates in R 
#Which month has the largest number of motor vehicle thefts for which an arrest was made?
which.max(table(mvt$Arrest=="TRUE",mvt$Month)[2,])

#Problem 3.1 - Visualizing Crime Trends
hist(mvt$Date, breaks=100)

#Problem 3.3 - Visualizing Crime Trends
#For what proportion of motor vehicle thefts in 2001 was an arrest made?
sum(mvt$Arrest=="TRUE"&mvt$Year==2001,na.rm=TRUE)/sum(mvt$Year==2001,na.rm=TRUE)
table(mvt$Arrest, mvt$Year)
sort(table(mvt$LocationDescription))
TopLocations = c("STREET", "PARKING LOT/GARAGE(NON.RESID.)", "ALLEY", "GAS STATION", "DRIVEWAY - RESIDENTIAL")
Top5 = subset(mvt, LocationDescription %in% TopLocations)
str(Top5)
#Top5 = subset(mvt, LocationDescription=="STREET" | LocationDescription=="PARKING LOT/GARAGE(NON.RESID.)" | LocationDescription=="ALLEY" | LocationDescription=="GAS STATION" | LocationDescription=="DRIVEWAY - RESIDENTIAL")
